# ุฑุงูููุง ุฑูุน ุฎุทุง Authentication

## ูุดฺฉู ูุนู
ุฎุทุง `Authentication failed` - ูุงู ฺฉุงุฑุจุฑ ุง ุฑูุฒ ุนุจูุฑ PostgreSQL ุฏุฑุณุช ูุณุช.

## โ ุฑุงูโุญู ุณุฑุน

### ูุฑุญูู 1: ุงุฌุฑุง ุงุณฺฉุฑูพุช ุฑุงูโุงูุฏุงุฒ

ุงู ุงุณฺฉุฑูพุช ุฏุชุงุจุณ ู ฺฉุงุฑุจุฑ ุฑุง ุจุฑุง ุดูุง ุงุฌุงุฏ ูโฺฉูุฏ:

```bash
./setup_database.sh
```

ุง ุฏุณุช:

```bash
sudo -u postgres psql
```

ุณูพุณ ุงู ุฏุณุชูุฑุงุช ุฑุง ุงุฌุฑุง ฺฉูุฏ:

```sql
DROP DATABASE IF EXISTS hospital_db;
DROP USER IF EXISTS hospital_user;
CREATE USER hospital_user WITH PASSWORD 'hospital123';
CREATE DATABASE hospital_db OWNER hospital_user;
GRANT ALL PRIVILEGES ON DATABASE hospital_db TO hospital_user;
\c hospital_db
GRANT ALL ON SCHEMA public TO hospital_user;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON TABLES TO hospital_user;
ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL ON SEQUENCES TO hospital_user;
\q
```

### ูุฑุญูู 2: ุชูุธู ูุงู .env

ูุงู `.env` ุฑุง ุฏุฑ ุฑูุช ูพุฑูฺู ุงุฌุงุฏ ุง ูุฑุงุด ฺฉูุฏ:

```env
DATABASE_URL="postgresql://hospital_user:hospital123@localhost:5432/hospital_db?schema=public"
PORT=3001
```

### ูุฑุญูู 3: ุชุณุช ู ุงุฌุฑุง

```bash
# ุชุณุช ุงุชุตุงู (ุงุฎุชุงุฑ)
psql -U hospital_user -d hospital_db -h localhost

# ุงฺฏุฑ ุฎุทุง ุฏุงุฏุ ุงุฒ ุงู ุงุณุชูุงุฏู ฺฉูุฏ:
PGPASSWORD=hospital123 psql -U hospital_user -d hospital_db -h localhost -c "SELECT 1;"

# ุญุงูุง db:push ุฑุง ุงุฌุฑุง ฺฉูุฏ
npm run db:push
```

## ๐ ุฑุงูโุญู ุฌุงฺฏุฒู: ุงุณุชูุงุฏู ุงุฒ ฺฉุงุฑุจุฑ postgres

ุงฺฏุฑ ูโุฎูุงูุฏ ุงุฒ ฺฉุงุฑุจุฑ `postgres` ุงุณุชูุงุฏู ฺฉูุฏ:

### ุชูุธู ุฑูุฒ ุนุจูุฑ ุจุฑุง postgres:

```bash
sudo -u postgres psql
```

```sql
ALTER USER postgres PASSWORD 'your_password';
\q
```

ุณูพุณ ุฏุฑ `.env`:
```env
DATABASE_URL="postgresql://postgres:your_password@localhost:5432/hospital_db?schema=public"
PORT=3001
```

โ๏ธ **ุชูุฌู**: `your_password` ุฑุง ุจุง ุฑูุฒ ุนุจูุฑ ฺฉู ุงูุชุฎุงุจ ฺฉุฑุฏุฏ ุฌุงฺฏุฒู ฺฉูุฏ.

## ๐ ุฎูุงุตู ูุฑุงุญู

1. โ ุงุฌุฑุง `setup_database.sh` ุง ุฏุณุชูุฑุงุช SQL ุจุงูุง
2. โ ุงุฌุงุฏ/ูุฑุงุด ูุงู `.env` ุจุง DATABASE_URL ุฏุฑุณุช
3. โ ุงุฌุฑุง `npm run db:push`
4. โ ุฏุฑ ุตูุฑุช ููููุชุ ุงุฌุฑุง `npm run db:studio` ุจุฑุง ูุดุงูุฏู ุฏุชุงุจุณ

## ๐ ุนุจโุงุจ

**ุงฺฏุฑ ูููุฒ ุฎุทุง ูโุฏูุฏ:**

1. ุจุฑุฑุณ ฺฉูุฏ PostgreSQL ุฏุฑ ุญุงู ุงุฌุฑุงุณุช:
   ```bash
   sudo systemctl status postgresql
   ```

2. ุจุฑุฑุณ ฺฉูุฏ ุฏุชุงุจุณ ุงุฌุงุฏ ุดุฏู:
   ```bash
   sudo -u postgres psql -c "\l" | grep hospital_db
   ```

3. ุจุฑุฑุณ ฺฉูุฏ ฺฉุงุฑุจุฑ ุงุฌุงุฏ ุดุฏู:
   ```bash
   sudo -u postgres psql -c "\du" | grep hospital_user
   ```

4. ุชุณุช ุงุชุตุงู ูุณุชูู:
   ```bash
   PGPASSWORD=hospital123 psql -U hospital_user -d hospital_db -h localhost
   ```



